{% extends "gallery/dashboard/base.html" %}

{% block content %}
    <div id="dashboard_div" class="mdl-grid demo-content">
        <div class="demo-charts mdl-color--white mdl-shadow--2dp mdl-cell mdl-cell--12-col mdl-grid">
            <svg fill="currentColor" width="200px" height="200px" viewBox="0 0 1 1" class="demo-chart mdl-cell mdl-cell--4-col mdl-cell--3-col-desktop">
                <use xlink:href="#piechart" mask="url(#piemask)" />
                <text x="0.5" y="0.5" font-family="Roboto" font-size="0.3" fill="#888" text-anchor="middle" dy="0.1">82<tspan font-size="0.2" dy="-0.07">%</tspan></text>
            </svg>
            <svg fill="currentColor" width="200px" height="200px" viewBox="0 0 1 1" class="demo-chart mdl-cell mdl-cell--4-col mdl-cell--3-col-desktop">
                <use xlink:href="#piechart" mask="url(#piemask)" />
                <text x="0.5" y="0.5" font-family="Roboto" font-size="0.3" fill="#888" text-anchor="middle" dy="0.1">82<tspan dy="-0.07" font-size="0.2">%</tspan></text>
            </svg>
            <svg fill="currentColor" width="200px" height="200px" viewBox="0 0 1 1" class="demo-chart mdl-cell mdl-cell--4-col mdl-cell--3-col-desktop">
                <use xlink:href="#piechart" mask="url(#piemask)" />
                <text x="0.5" y="0.5" font-family="Roboto" font-size="0.3" fill="#888" text-anchor="middle" dy="0.1">82<tspan dy="-0.07" font-size="0.2">%</tspan></text>
            </svg>
            <svg fill="currentColor" width="200px" height="200px" viewBox="0 0 1 1" class="demo-chart mdl-cell mdl-cell--4-col mdl-cell--3-col-desktop">
                <use xlink:href="#piechart" mask="url(#piemask)" />
                <text x="0.5" y="0.5" font-family="Roboto" font-size="0.3" fill="#888" text-anchor="middle" dy="0.1">82<tspan dy="-0.07" font-size="0.2">%</tspan></text>
            </svg>
        </div>
        <div class="demo-graphs mdl-shadow--2dp mdl-color--white mdl-cell mdl-cell--8-col">
            <svg fill="currentColor" viewBox="0 0 500 250" class="demo-graph">
                <use xlink:href="#chart" />
            </svg>
            <svg fill="currentColor" viewBox="0 0 500 250" class="demo-graph">
                <use xlink:href="#chart" />
            </svg>
        </div>
        <div class="demo-cards mdl-cell mdl-cell--4-col mdl-cell--8-col-tablet mdl-grid mdl-grid--no-spacing">
            <div class="demo-updates mdl-card mdl-shadow--2dp mdl-cell mdl-cell--4-col mdl-cell--4-col-tablet mdl-cell--12-col-desktop">
                <div class="mdl-card__title mdl-card--expand mdl-color--teal-300">
                    <h2 class="mdl-card__title-text">Updates</h2>
                </div>
                <div class="mdl-card__supporting-text mdl-color-text--grey-600">
                    Non dolore elit adipisicing ea reprehenderit consectetur culpa.
                </div>
                <div class="mdl-card__actions mdl-card--border">
                    <a href="#" class="mdl-button mdl-js-button mdl-js-ripple-effect">Read More</a>
                </div>
            </div>

        <div class="demo-separator mdl-cell--1-col"></div>

            <!-- 用户注册审批卡片 -->
            <div class="demo-options mdl-card mdl-color--deep-purple-500 mdl-shadow--2dp mdl-cell mdl-cell--4-col mdl-cell--3-col-tablet mdl-cell--12-col-desktop">
                <div class="mdl-card__supporting-text mdl-color-text--blue-grey-50">
                    <h3>UserManagement</h3>
                    <p v-show="user_management_text_show">[[ user_management_text ]]</p>
                    <ul v-for="user in user_list" class="mdl-list">
                        <li v-show="!user.user_status" class="mdl-list__item">
                            <span class="mdl-list__item-primary-content" style="color: #ece6f6">
                                <i class="material-icons mdl-list__item-icon">person</i>
                                [[ user.username ]]
                            </span>
                        </li>
                    </ul>
                </div>
                <div class="mdl-card__actions mdl-card--border">
                    <a href="{% url 'gallery:dashboard:user_management' %}" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-color-text--blue-grey-50">Go to checkout</a>
                    <div class="mdl-layout-spacer"></div>
                </div>
            </div>
        </div>
    </div>
    <script>
    var dashboard_app = new Vue({
        delimiters: ['[[', ']]'],
        el: '#dashboard_div',
        data: {
            user_list: [],
            user_management_text: '',
            user_management_text_show: true,
        },
        created: function () {
            progress_bar_app.show = true
            axios.post('{% url "gallery:api:user_management_user_list" %}', {})
            .then(function (response) {
                dashboard_app.user_list = response.data['user_list']
                var has_user = false
                for (const user of dashboard_app.user_list) {
                    if (!user.is_active) {
                        has_user = true
                    }
                }
                if (has_user) {
                    dashboard_app.user_management_text = 'Here are some user wait to sign up, please check.'
                } else {
                    dashboard_app.user_management_text = '\nNothing to do here'
                }
            })
            .catch(function (errno) {
                errorDialog(error)
            })
            .finally(function () {
                progress_bar_app.show = false
            })
        }
    })
    </script>
{% endblock %}
